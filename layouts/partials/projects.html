{{ $projects := .Site.Data.projects }}
{{ $featured := where $projects "featured" true }}
{{ if not $featured }}
{{ $featured = first 2 $projects }}
{{ end }}

<section id="projects" class="section">
    <div class="section-header">
        <h2 class="section-title">Recent projects</h2>
        {{ if gt (len $projects) (len $featured) }}
        <a href="/projects/" class="section-link">See all projects</a>
        {{ end }}
    </div>
    <div class="home-post-list">
        {{ range $featured }}
        <div class="home-post-item">
            <div class="home-post-info">
                <h3 class="home-post-title">{{ .name }}</h3>
                <div class="home-project-links">
                    {{ with .githubUrl }}
                    <a href="{{ . }}" target="_blank" rel="noopener noreferrer" class="home-project-link">Source Code →</a>
                    {{ end }}
                    {{ with .deployUrl }}
                    <a href="{{ . }}" target="_blank" rel="noopener noreferrer" class="home-project-link">Live →</a>
                    {{ end }}
                </div>
            </div>
            <p class="home-post-desc">{{ .description }}</p>
        </div>
        {{ end }}
    </div>
</section>